from structures.Structure import Structure
from structures.ProductFamily import *
from awslogger import logger


class FinesReformReg(Structure):
    product_family_name = PRODUCT_FAMILY_FINES_REFORM_REG
    supported_product_codes = ['PNDL1286', 'PVRI1285']

    def parse(self, lines: list) -> list:

        headers = {
            'Detail Record Type': [1, 1],
            'Letter Code': [2, 8],
            Structure.profile_table_mappings['client_id']: [10, 9],
            'Client Type': [19, 1],
            'Name': [20, 30],
            'NameLine2': [50, 30],
            'Post_Address_1': [80, 30],
            'Post_Address_2': [110, 30],
            'Post_Suburb': [140, 30],
            'Post_State': [170, 3],
            'PostCode': [173, 4],
            'Salutation': [177, 30],
            'Reg Count': [207, 3],
            'Plate Number_1': [210, 10],
            'Plate Class_1': [220, 1],
            'Serial Number_1': [221, 8],
            'Make_1': [229, 52],
            'Model_1': [281, 6],
            'Manuf Year_1': [287, 4],
            'Status_1': [291, 20],
            'Expiry Date_1': [311, 8],
            'Cancelled_Scheduled_Date_1': [319, 8],
            'Plate Number_2': [327, 10],
            'Plate Class_2': [337, 1],
            'Serial Number_2': [338, 8],
            'Make_2': [346, 52],
            'Model_2': [398, 6],
            'Manuf Year_2': [404, 4],
            'Status_2': [408, 20],
            'Expiry Date_2': [428, 8],
            'Cancelled Scheduled date_2': [436, 8],
            'Plate Number_3': [444, 10],
            'Plate Class_3': [454, 1],
            'Serial Number_3': [455, 8],
            'Make_3': [463, 52],
            'Model_3': [515, 6],
            'Manuf Year_3': [521, 4],
            'Status_3': [525, 20],
            'Expiry Date_3': [545, 8],
            'Cancelled Scheduled date_3': [553, 8],
            'Plate Number_4': [561, 10],
            'Plate Class_4': [571, 1],
            'Serial Number_4': [572, 8],
            'Make_4': [580, 52],
            'Model_4': [632, 6],
            'Manuf Year_4': [638, 4],
            'Status_4': [642, 20],
            'Expiry Date_4': [662, 8],
            'Cancelled Scheduled date_4': [670, 8],
            'Plate Number_5': [678, 10],
            'Plate Class_5': [688, 1],
            'Serial Number_5': [689, 8],
            'Make_5': [697, 52],
            'Model_5': [749, 6],
            'Manuf Year_5': [755, 4],
            'Status_5': [759, 20],
            'Expiry Date_5': [779, 8],
            'Cancelled Scheduled date_5': [787, 8],
            'Plate Number_6': [795, 10],
            'Plate Class_6': [805, 1],
            'Serial Number_6': [806, 8],
            'Make_6': [814, 52],
            'Model_6': [866, 6],
            'Manuf Year_6': [872, 4],
            'Status_6': [876, 20],
            'Expiry Date_6': [896, 8],
            'Cancelled Scheduled date_6': [904, 8],
            'Plate Number_7': [912, 10],
            'Plate Class_7': [922, 1],
            'Serial Number_7': [923, 8],
            'Make_7': [931, 52],
            'Model_7': [983, 6],
            'Manuf Year_7': [989, 4],
            'Status_7': [993, 20],
            'Expiry Date_7': [1013, 8],
            'Cancelled Scheduled date_7': [1021, 8],
            'Plate Number_8': [1029, 10],
            'Plate Class_8': [1039, 1],
            'Serial Number_8': [1040, 8],
            'Make_8': [1048, 52],
            'Model_8': [1100, 6],
            'Manuf Year_8': [1106, 4],
            'Status_8': [1110, 20],
            'Expiry Date_8': [1130, 8],
            'Cancelled Scheduled date_8': [1138, 8],
            'Plate Number_9': [1146, 10],
            'Plate Class_9': [1156, 1],
            'Serial Number_9': [1157, 8],
            'Make_9': [1165, 52],
            'Model_9': [1217, 6],
            'Manuf Year_9': [1223, 4],
            'Status_9': [1227, 20],
            'Expiry Date_9': [1247, 8],
            'Cancelled Scheduled date_9': [1255, 8],
            'Plate Number_10': [1263, 10],
            'Plate Class_10': [1273, 1],
            'Serial Number_10': [1274, 8],
            'Make_10': [1282, 52],
            'Model_10': [1334, 6],
            'Manuf Year_10': [1340, 4],
            'Status_10': [1344, 20],
            'Expiry Date_10': [1364, 8],
            'Cancelled Scheduled date_10': [1372, 8],
            'Plate Number_11': [1380, 10],
            'Plate Class_11': [1390, 1],
            'Serial Number_11': [1391, 8],
            'Make_11': [1399, 52],
            'Model_11': [1451, 6],
            'Manuf Year_11': [1457, 4],
            'Status_11': [1461, 20],
            'Expiry Date_11': [1481, 8],
            'Cancelled Scheduled date_11': [1489, 8],
            'Plate Number_12': [1497, 10],
            'Plate Class_12': [1507, 1],
            'Serial Number_12': [1508, 8],
            'Make_12': [1516, 52],
            'Model_12': [1568, 6],
            'Manuf Year_12': [1574, 4],
            'Status_12': [1578, 20],
            'Expiry Date_12': [1598, 8],
            'Cancelled Scheduled date_12': [1606, 8],
            'Plate Number_13': [1614, 10],
            'Plate Class_13': [1624, 1],
            'Serial Number_13': [1625, 8],
            'Make_13': [1633, 52],
            'Model_13': [1685, 6],
            'Manuf Year_13': [1691, 4],
            'Status_13': [1695, 20],
            'Expiry Date_13': [1715, 8],
            'Cancelled Scheduled date_13': [1723, 8],
            'Plate Number_14': [1731, 10],
            'Plate Class_14': [1741, 1],
            'Serial Number_14': [1742, 8],
            'Make_14': [1750, 52],
            'Model_14': [1802, 6],
            'Manuf Year_14': [1808, 4],
            'Status_14': [1812, 20],
            'Expiry Date_14': [1832, 8],
            'Cancelled Scheduled date_14': [1840, 8],
            'Plate Number_15': [1848, 10],
            'Plate Class_15': [1858, 1],
            'Serial Number_15': [1859, 8],
            'Make_15': [1867, 52],
            'Model_15': [1919, 6],
            'Manuf Year_15': [1925, 4],
            'Status_15': [1929, 20],
            'Expiry Date_15': [1949, 8],
            'Cancelled Scheduled date_15': [1957, 8],
            'Plate Number_16': [1965, 10],
            'Plate Class_16': [1975, 1],
            'Serial Number_16': [1976, 8],
            'Make_16': [1984, 52],
            'Model_16': [2036, 6],
            'Manuf Year_16': [2042, 4],
            'Status_16': [2046, 20],
            'Expiry Date_16': [2066, 8],
            'Cancelled Scheduled date_16': [2074, 8],
            'Plate Number_17': [2082, 10],
            'Plate Class_17': [2092, 1],
            'Serial Number_17': [2093, 8],
            'Make_17': [2101, 52],
            'Model_17': [2153, 6],
            'Manuf Year_17': [2159, 4],
            'Status_17': [2163, 20],
            'Expiry Date_17': [2183, 8],
            'Cancelled Scheduled date_17': [2191, 8],
            'Plate Number_18': [2199, 10],
            'Plate Class_18': [2209, 1],
            'Serial Number_18': [2210, 8],
            'Make_18': [2218, 52],
            'Model_18': [2270, 6],
            'Manuf Year_18': [2276, 4],
            'Status_18': [2280, 20],
            'Expiry Date_18': [2300, 8],
            'Cancelled Scheduled date_18': [2308, 8],
            'Plate Number_19': [2316, 10],
            'Plate Class_19': [2326, 1],
            'Serial Number_19': [2327, 8],
            'Make_19': [2335, 52],
            'Model_19': [2387, 6],
            'Manuf Year_19': [2393, 4],
            'Status_19': [2397, 20],
            'Expiry Date_19': [2417, 8],
            'Cancelled Scheduled date_19': [2425, 8],
            'Plate Number_20': [2433, 10],
            'Plate Class_20': [2443, 1],
            'Serial Number_20': [2444, 8],
            'Make_20': [2452, 52],
            'Model_20': [2504, 6],
            'Manuf Year_20': [2510, 4],
            'Status_20': [2514, 20],
            'Expiry Date_20': [2534, 8],
            'Cancelled Scheduled date_20': [2542, 8],
            'Plate Number_21': [2550, 10],
            'Plate Class_21': [2560, 1],
            'Serial Number_21': [2561, 8],
            'Make_21': [2569, 52],
            'Model_21': [2621, 6],
            'Manuf Year_21': [2627, 4],
            'Status_21': [2631, 20],
            'Expiry Date_21': [2651, 8],
            'Cancelled Scheduled date_21': [2659, 8],
            'Plate Number_22': [2667, 10],
            'Plate Class_22': [2677, 1],
            'Serial Number_22': [2678, 8],
            'Make_22': [2686, 52],
            'Model_22': [2738, 6],
            'Manuf Year_22': [2744, 4],
            'Status_22': [2748, 20],
            'Expiry Date_22': [2768, 8],
            'Cancelled Scheduled date_22': [2776, 8],
            'Plate Number_23': [2784, 10],
            'Plate Class_23': [2794, 1],
            'Serial Number_23': [2795, 8],
            'Make_23': [2803, 52],
            'Model_23': [2855, 6],
            'Manuf Year_23': [2861, 4],
            'Status_23': [2865, 20],
            'Expiry Date_23': [2885, 8],
            'Cancelled Scheduled date_23': [2893, 8],
            'Plate Number_24': [2901, 10],
            'Plate Class_24': [2911, 1],
            'Serial Number_24': [2912, 8],
            'Make_24': [2920, 52],
            'Model_24': [2972, 6],
            'Manuf Year_24': [2978, 4],
            'Status_24': [2982, 20],
            'Expiry Date_24': [3002, 8],
            'Cancelled Scheduled date_24': [3010, 8],
            'Plate Number_25': [3018, 10],
            'Plate Class_25': [3028, 1],
            'Serial Number_25': [3029, 8],
            'Make_25': [3037, 52],
            'Model_25': [3089, 6],
            'Manuf Year_25': [3095, 4],
            'Status_25': [3099, 20],
            'Expiry Date_25': [3119, 8],
            'Cancelled Scheduled date_25': [3127, 8],
            'Plate Number_26': [3135, 10],
            'Plate Class_26': [3145, 1],
            'Serial Number_26': [3146, 8],
            'Make_26': [3154, 52],
            'Model_26': [3206, 6],
            'Manuf Year_26': [3212, 4],
            'Status_26': [3216, 20],
            'Expiry Date_26': [3236, 8],
            'Cancelled Scheduled date_26': [3244, 8],
            'Plate Number_27': [3252, 10],
            'Plate Class_27': [3262, 1],
            'Serial Number_27': [3263, 8],
            'Make_27': [3271, 52],
            'Model_27': [3323, 6],
            'Manuf Year_27': [3329, 4],
            'Status_27': [3333, 20],
            'Expiry Date_27': [3353, 8],
            'Cancelled Scheduled date_27': [3361, 8],
            'Plate Number_28': [3369, 10],
            'Plate Class_28': [3379, 1],
            'Serial Number_28': [3380, 8],
            'Make_28': [3388, 52],
            'Model_28': [3440, 6],
            'Manuf Year_28': [3446, 4],
            'Status_28': [3450, 20],
            'Expiry Date_28': [3470, 8],
            'Cancelled Scheduled date_28': [3478, 8],
            'Plate Number_29': [3486, 10],
            'Plate Class_29': [3496, 1],
            'Serial Number_29': [3497, 8],
            'Make_29': [3505, 52],
            'Model_29': [3557, 6],
            'Manuf Year_29': [3563, 4],
            'Status_29': [3567, 20],
            'Expiry Date_29': [3587, 8],
            'Cancelled Scheduled date_29': [3595, 8],
            'Plate Number_30': [3603, 10],
            'Plate Class_30': [3613, 1],
            'Serial Number_30': [3614, 8],
            'Make_30': [3622, 52],
            'Model_30': [3674, 6],
            'Manuf Year_30': [3680, 4],
            'Status_30': [3684, 20],
            'Expiry Date_30': [3704, 8],
            'Cancelled Scheduled date_30': [3712, 8],
            'Plate Number_31': [3720, 10],
            'Plate Class_31': [3730, 1],
            'Serial Number_31': [3731, 8],
            'Make_31': [3739, 52],
            'Model_31': [3791, 6],
            'Manuf Year_31': [3797, 4],
            'Status_31': [3801, 20],
            'Expiry Date_31': [3821, 8],
            'Cancelled Scheduled date_31': [3829, 8],
            'Plate Number_32': [3837, 10],
            'Plate Class_32': [3847, 1],
            'Serial Number_32': [3848, 8],
            'Make_32': [3856, 52],
            'Model_32': [3908, 6],
            'Manuf Year_32': [3914, 4],
            'Status_32': [3918, 20],
            'Expiry Date_32': [3938, 8],
            'Cancelled Scheduled date_32': [3946, 8],
            'Plate Number_33': [3954, 10],
            'Plate Class_33': [3964, 1],
            'Serial Number_33': [3965, 8],
            'Make_33': [3973, 52],
            'Model_33': [4025, 6],
            'Manuf Year_33': [4031, 4],
            'Status_33': [4035, 20],
            'Expiry Date_33': [4055, 8],
            'Cancelled Scheduled date_33': [4063, 8],
            'Plate Number_34': [4071, 10],
            'Plate Class_34': [4081, 1],
            'Serial Number_34': [4082, 8],
            'Make_34': [4090, 52],
            'Model_34': [4142, 6],
            'Manuf Year_34': [4148, 4],
            'Status_34': [4152, 20],
            'Expiry Date_34': [4172, 8],
            'Cancelled Scheduled date_34': [4180, 8],
            'Plate Number_35': [4188, 10],
            'Plate Class_35': [4198, 1],
            'Serial Number_35': [4199, 8],
            'Make_35': [4207, 52],
            'Model_35': [4259, 6],
            'Manuf Year_35': [4265, 4],
            'Status_35': [4269, 20],
            'Expiry Date_35': [4289, 8],
            'Cancelled Scheduled date_35': [4297, 8],
            'Plate Number_36': [4305, 10],
            'Plate Class_36': [4315, 1],
            'Serial Number_36': [4316, 8],
            'Make_36': [4324, 52],
            'Model_36': [4376, 6],
            'Manuf Year_36': [4382, 4],
            'Status_36': [4386, 20],
            'Expiry Date_36': [4406, 8],
            'Cancelled Scheduled date_36': [4414, 8],
            'Plate Number_37': [4422, 10],
            'Plate Class_37': [4432, 1],
            'Serial Number_37': [4433, 8],
            'Make_37': [4441, 52],
            'Model_37': [4493, 6],
            'Manuf Year_37': [4499, 4],
            'Status_37': [4503, 20],
            'Expiry Date_37': [4523, 8],
            'Cancelled Scheduled date_37': [4531, 8],
            'Plate Number_38': [4539, 10],
            'Plate Class_38': [4549, 1],
            'Serial Number_38': [4550, 8],
            'Make_38': [4558, 52],
            'Model_38': [4610, 6],
            'Manuf Year_38': [4616, 4],
            'Status_38': [4620, 20],
            'Expiry Date_38': [4640, 8],
            'Cancelled Scheduled date_38': [4648, 8],
            'Plate Number_39': [4656, 10],
            'Plate Class_39': [4666, 1],
            'Serial Number_39': [4667, 8],
            'Make_39': [4675, 52],
            'Model_39': [4727, 6],
            'Manuf Year_39': [4733, 4],
            'Status_39': [4737, 20],
            'Expiry Date_39': [4757, 8],
            'Cancelled Scheduled date_39': [4765, 8],
            'Plate Number_40': [4773, 10],
            'Plate Class_40': [4783, 1],
            'Serial Number_40': [4784, 8],
            'Make_40': [4792, 52],
            'Model_40': [4844, 6],
            'Manuf Year_40': [4850, 4],
            'Status_40': [4854, 20],
            'Expiry Date_40': [4874, 8],
            'Cancelled Scheduled date_40': [4882, 8],
            'Plate Number_41': [4890, 10],
            'Plate Class_41': [4900, 1],
            'Serial Number_41': [4901, 8],
            'Make_41': [4909, 52],
            'Model_41': [4961, 6],
            'Manuf Year_41': [4967, 4],
            'Status_41': [4971, 20],
            'Expiry Date_41': [4991, 8],
            'Cancelled Scheduled date_41': [4999, 8],
            'Plate Number_42': [5007, 10],
            'Plate Class_42': [5017, 1],
            'Serial Number_42': [5018, 8],
            'Make_42': [5026, 52],
            'Model_42': [5078, 6],
            'Manuf Year_42': [5084, 4],
            'Status_42': [5088, 20],
            'Expiry Date_42': [5108, 8],
            'Cancelled Scheduled date_42': [5116, 8],
            'Plate Number_43': [5124, 10],
            'Plate Class_43': [5134, 1],
            'Serial Number_43': [5135, 8],
            'Make_43': [5143, 52],
            'Model_43': [5195, 6],
            'Manuf Year_43': [5201, 4],
            'Status_43': [5205, 20],
            'Expiry Date_43': [5225, 8],
            'Cancelled Scheduled date_43': [5233, 8],
            'Plate Number_44': [5241, 10],
            'Plate Class_44': [5251, 1],
            'Serial Number_44': [5252, 8],
            'Make_44': [5260, 52],
            'Model_44': [5312, 6],
            'Manuf Year_44': [5318, 4],
            'Status_44': [5322, 20],
            'Expiry Date_44': [5342, 8],
            'Cancelled Scheduled date_44': [5350, 8],
            'Plate Number_45': [5358, 10],
            'Plate Class_45': [5368, 1],
            'Serial Number_45': [5369, 8],
            'Make_45': [5377, 52],
            'Model_45': [5429, 6],
            'Manuf Year_45': [5435, 4],
            'Status_45': [5439, 20],
            'Expiry Date_45': [5459, 8],
            'Cancelled Scheduled date_45': [5467, 8],
            'Plate Number_46': [5475, 10],
            'Plate Class_46': [5485, 1],
            'Serial Number_46': [5486, 8],
            'Make_46': [5494, 52],
            'Model_46': [5546, 6],
            'Manuf Year_46': [5552, 4],
            'Status_46': [5556, 20],
            'Expiry Date_46': [5576, 8],
            'Cancelled Scheduled date_46': [5584, 8],
            'Plate Number_47': [5592, 10],
            'Plate Class_47': [5602, 1],
            'Serial Number_47': [5603, 8],
            'Make_47': [5611, 52],
            'Model_47': [5663, 6],
            'Manuf Year_47': [5669, 4],
            'Status_47': [5673, 20],
            'Expiry Date_47': [5693, 8],
            'Cancelled Scheduled date_47': [5701, 8],
            'Plate Number_48': [5709, 10],
            'Plate Class_48': [5719, 1],
            'Serial Number_48': [5720, 8],
            'Make_48': [5728, 52],
            'Model_48': [5780, 6],
            'Manuf Year_48': [5786, 4],
            'Status_48': [5790, 20],
            'Expiry Date_48': [5810, 8],
            'Cancelled Scheduled date_48': [5818, 8],
            'Plate Number_49': [5826, 10],
            'Plate Class_49': [5836, 1],
            'Serial Number_49': [5837, 8],
            'Make_49': [5845, 52],
            'Model_49': [5897, 6],
            'Manuf Year_49': [5903, 4],
            'Status_49': [5907, 20],
            'Expiry Date_49': [5927, 8],
            'Cancelled Scheduled date_49': [5935, 8],
            'Plate Number_50': [5943, 10],
            'Plate Class_50': [5953, 1],
            'Serial Number_50': [5954, 8],
            'Make_50': [5962, 52],
            'Model_50': [6014, 6],
            'Manuf Year_50': [6020, 4],
            'Status_50': [6024, 20],
            'Expiry Date_50': [6044, 8],
            'Cancelled Scheduled date_50': [6052, 8],
            'Plate Number_51': [6060, 10],
            'Plate Class_51': [6070, 1],
            'Serial Number_51': [6071, 8],
            'Make_51': [6079, 52],
            'Model_51': [6131, 6],
            'Manuf Year_51': [6137, 4],
            'Status_51': [6141, 20],
            'Expiry Date_51': [6161, 8],
            'Cancelled Scheduled date_51': [6169, 8],
            'Plate Number_52': [6177, 10],
            'Plate Class_52': [6187, 1],
            'Serial Number_52': [6188, 8],
            'Make_52': [6196, 52],
            'Model_52': [6248, 6],
            'Manuf Year_52': [6254, 4],
            'Status_52': [6258, 20],
            'Expiry Date_52': [6278, 8],
            'Cancelled Scheduled date_52': [6286, 8],
            'Plate Number_53': [6294, 10],
            'Plate Class_53': [6304, 1],
            'Serial Number_53': [6305, 8],
            'Make_53': [6313, 52],
            'Model_53': [6365, 6],
            'Manuf Year_53': [6371, 4],
            'Status_53': [6375, 20],
            'Expiry Date_53': [6395, 8],
            'Cancelled Scheduled date_53': [6403, 8],
            'Plate Number_54': [6411, 10],
            'Plate Class_54': [6421, 1],
            'Serial Number_54': [6422, 8],
            'Make_54': [6430, 52],
            'Model_54': [6482, 6],
            'Manuf Year_54': [6488, 4],
            'Status_54': [6492, 20],
            'Expiry Date_54': [6512, 8],
            'Cancelled Scheduled date_54': [6520, 8],
            'Plate Number_55': [6528, 10],
            'Plate Class_55': [6538, 1],
            'Serial Number_55': [6539, 8],
            'Make_55': [6547, 52],
            'Model_55': [6599, 6],
            'Manuf Year_55': [6605, 4],
            'Status_55': [6609, 20],
            'Expiry Date_55': [6629, 8],
            'Cancelled Scheduled date_55': [6637, 8],
            'Plate Number_56': [6645, 10],
            'Plate Class_56': [6655, 1],
            'Serial Number_56': [6656, 8],
            'Make_56': [6664, 52],
            'Model_56': [6716, 6],
            'Manuf Year_56': [6722, 4],
            'Status_56': [6726, 20],
            'Expiry Date_56': [6746, 8],
            'Cancelled Scheduled date_56': [6754, 8],
            'Plate Number_57': [6762, 10],
            'Plate Class_57': [6772, 1],
            'Serial Number_57': [6773, 8],
            'Make_57': [6781, 52],
            'Model_57': [6833, 6],
            'Manuf Year_57': [6839, 4],
            'Status_57': [6843, 20],
            'Expiry Date_57': [6863, 8],
            'Cancelled Scheduled date_57': [6871, 8],
            'Plate Number_58': [6879, 10],
            'Plate Class_58': [6889, 1],
            'Serial Number_58': [6890, 8],
            'Make_58': [6898, 52],
            'Model_58': [6950, 6],
            'Manuf Year_58': [6956, 4],
            'Status_58': [6960, 20],
            'Expiry Date_58': [6980, 8],
            'Cancelled Scheduled date_58': [6988, 8],
            'Plate Number_59': [6996, 10],
            'Plate Class_59': [7006, 1],
            'Serial Number_59': [7007, 8],
            'Make_59': [7015, 52],
            'Model_59': [7067, 6],
            'Manuf Year_59': [7073, 4],
            'Status_59': [7077, 20],
            'Expiry Date_59': [7097, 8],
            'Cancelled Scheduled date_59': [7105, 8],
            'Plate Number_60': [7113, 10],
            'Plate Class_60': [7123, 1],
            'Serial Number_60': [7124, 8],
            'Make_60': [7132, 52],
            'Model_60': [7184, 6],
            'Manuf Year_60': [7190, 4],
            'Status_60': [7194, 20],
            'Expiry Date_60': [7214, 8],
            'Cancelled Scheduled date_60': [7222, 8],
            'Plate Number_61': [7230, 10],
            'Plate Class_61': [7240, 1],
            'Serial Number_61': [7241, 8],
            'Make_61': [7249, 52],
            'Model_61': [7301, 6],
            'Manuf Year_61': [7307, 4],
            'Status_61': [7311, 20],
            'Expiry Date_61': [7331, 8],
            'Cancelled Scheduled date_61': [7339, 8],
            'Plate Number_62': [7347, 10],
            'Plate Class_62': [7357, 1],
            'Serial Number_62': [7358, 8],
            'Make_62': [7366, 52],
            'Model_62': [7418, 6],
            'Manuf Year_62': [7424, 4],
            'Status_62': [7428, 20],
            'Expiry Date_62': [7448, 8],
            'Cancelled Scheduled date_62': [7456, 8],
            'Plate Number_63': [7464, 10],
            'Plate Class_63': [7474, 1],
            'Serial Number_63': [7475, 8],
            'Make_63': [7483, 52],
            'Model_63': [7535, 6],
            'Manuf Year_63': [7541, 4],
            'Status_63': [7545, 20],
            'Expiry Date_63': [7565, 8],
            'Cancelled Scheduled date_63': [7573, 8],
            'Plate Number_64': [7581, 10],
            'Plate Class_64': [7591, 1],
            'Serial Number_64': [7592, 8],
            'Make_64': [7600, 52],
            'Model_64': [7652, 6],
            'Manuf Year_64': [7658, 4],
            'Status_64': [7662, 20],
            'Expiry Date_64': [7682, 8],
            'Cancelled Scheduled date_64': [7690, 8],
            'Plate Number_65': [7698, 10],
            'Plate Class_65': [7708, 1],
            'Serial Number_65': [7709, 8],
            'Make_65': [7717, 52],
            'Model_65': [7769, 6],
            'Manuf Year_65': [7775, 4],
            'Status_65': [7779, 20],
            'Expiry Date_65': [7799, 8],
            'Cancelled Scheduled date_65': [7807, 8],
            'Plate Number_66': [7815, 10],
            'Plate Class_66': [7825, 1],
            'Serial Number_66': [7826, 8],
            'Make_66': [7834, 52],
            'Model_66': [7886, 6],
            'Manuf Year_66': [7892, 4],
            'Status_66': [7896, 20],
            'Expiry Date_66': [7916, 8],
            'Cancelled Scheduled date_66': [7924, 8],
            'Plate Number_67': [7932, 10],
            'Plate Class_67': [7942, 1],
            'Serial Number_67': [7943, 8],
            'Make_67': [7951, 52],
            'Model_67': [8003, 6],
            'Manuf Year_67': [8009, 4],
            'Status_67': [8013, 20],
            'Expiry Date_67': [8033, 8],
            'Cancelled Scheduled date_67': [8041, 8],
            'Plate Number_68': [8049, 10],
            'Plate Class_68': [8059, 1],
            'Serial Number_68': [8060, 8],
            'Make_68': [8068, 52],
            'Model_68': [8120, 6],
            'Manuf Year_68': [8126, 4],
            'Status_68': [8130, 20],
            'Expiry Date_68': [8150, 8],
            'Cancelled Scheduled date_68': [8158, 8],
            'Plate Number_69': [8166, 10],
            'Plate Class_69': [8176, 1],
            'Serial Number_69': [8177, 8],
            'Make_69': [8185, 52],
            'Model_69': [8237, 6],
            'Manuf Year_69': [8243, 4],
            'Status_69': [8247, 20],
            'Expiry Date_69': [8267, 8],
            'Cancelled Scheduled date_69': [8275, 8],
            'Plate Number_70': [8283, 10],
            'Plate Class_70': [8293, 1],
            'Serial Number_70': [8294, 8],
            'Make_70': [8302, 52],
            'Model_70': [8354, 6],
            'Manuf Year_70': [8360, 4],
            'Status_70': [8364, 20],
            'Expiry Date_70': [8384, 8],
            'Cancelled Scheduled date_70': [8392, 8],
            'Plate Number_71': [8400, 10],
            'Plate Class_71': [8410, 1],
            'Serial Number_71': [8411, 8],
            'Make_71': [8419, 52],
            'Model_71': [8471, 6],
            'Manuf Year_71': [8477, 4],
            'Status_71': [8481, 20],
            'Expiry Date_71': [8501, 8],
            'Cancelled Scheduled date_71': [8509, 8],
            'Plate Number_72': [8517, 10],
            'Plate Class_72': [8527, 1],
            'Serial Number_72': [8528, 8],
            'Make_72': [8536, 52],
            'Model_72': [8588, 6],
            'Manuf Year_72': [8594, 4],
            'Status_72': [8598, 20],
            'Expiry Date_72': [8618, 8],
            'Cancelled Scheduled date_72': [8626, 8],
            'Plate Number_73': [8634, 10],
            'Plate Class_73': [8644, 1],
            'Serial Number_73': [8645, 8],
            'Make_73': [8653, 52],
            'Model_73': [8705, 6],
            'Manuf Year_73': [8711, 4],
            'Status_73': [8715, 20],
            'Expiry Date_73': [8735, 8],
            'Cancelled Scheduled date_73': [8743, 8],
            'Plate Number_74': [8751, 10],
            'Plate Class_74': [8761, 1],
            'Serial Number_74': [8762, 8],
            'Make_74': [8770, 52],
            'Model_74': [8822, 6],
            'Manuf Year_74': [8828, 4],
            'Status_74': [8832, 20],
            'Expiry Date_74': [8852, 8],
            'Cancelled Scheduled date_74': [8860, 8],
            'Plate Number_75': [8868, 10],
            'Plate Class_75': [8878, 1],
            'Serial Number_75': [8879, 8],
            'Make_75': [8887, 52],
            'Model_75': [8939, 6],
            'Manuf Year_75': [8945, 4],
            'Status_75': [8949, 20],
            'Expiry Date_75': [8969, 8],
            'Cancelled Scheduled date_75': [8977, 8],
            'Plate Number_76': [8985, 10],
            'Plate Class_76': [8995, 1],
            'Serial Number_76': [8996, 8],
            'Make_76': [9004, 52],
            'Model_76': [9056, 6],
            'Manuf Year_76': [9062, 4],
            'Status_76': [9066, 20],
            'Expiry Date_76': [9086, 8],
            'Cancelled Scheduled date_76': [9094, 8],
            'Plate Number_77': [9102, 10],
            'Plate Class_77': [9112, 1],
            'Serial Number_77': [9113, 8],
            'Make_77': [9121, 52],
            'Model_77': [9173, 6],
            'Manuf Year_77': [9179, 4],
            'Status_77': [9183, 20],
            'Expiry Date_77': [9203, 8],
            'Cancelled Scheduled date_77': [9211, 8],
            'Plate Number_78': [9219, 10],
            'Plate Class_78': [9229, 1],
            'Serial Number_78': [9230, 8],
            'Make_78': [9238, 52],
            'Model_78': [9290, 6],
            'Manuf Year_78': [9296, 4],
            'Status_78': [9300, 20],
            'Expiry Date_78': [9320, 8],
            'Cancelled Scheduled date_78': [9328, 8],
            'Plate Number_79': [9336, 10],
            'Plate Class_79': [9346, 1],
            'Serial Number_79': [9347, 8],
            'Make_79': [9355, 52],
            'Model_79': [9407, 6],
            'Manuf Year_79': [9413, 4],
            'Status_79': [9417, 20],
            'Expiry Date_79': [9437, 8],
            'Cancelled Scheduled date_79': [9445, 8],
            'Plate Number_80': [9453, 10],
            'Plate Class_80': [9463, 1],
            'Serial Number_80': [9464, 8],
            'Make_80': [9472, 52],
            'Model_80': [9524, 6],
            'Manuf Year_80': [9530, 4],
            'Status_80': [9534, 20],
            'Expiry Date_80': [9554, 8],
            'Cancelled Scheduled date_80': [9562, 8],
            'Plate Number_81': [9570, 10],
            'Plate Class_81': [9580, 1],
            'Serial Number_81': [9581, 8],
            'Make_81': [9589, 52],
            'Model_81': [9641, 6],
            'Manuf Year_81': [9647, 4],
            'Status_81': [9651, 20],
            'Expiry Date_81': [9671, 8],
            'Cancelled Scheduled date_81': [9679, 8],
            'Plate Number_82': [9687, 10],
            'Plate Class_82': [9697, 1],
            'Serial Number_82': [9698, 8],
            'Make_82': [9706, 52],
            'Model_82': [9758, 6],
            'Manuf Year_82': [9764, 4],
            'Status_82': [9768, 20],
            'Expiry Date_82': [9788, 8],
            'Cancelled Scheduled date_82': [9796, 8],
            'Plate Number_83': [9804, 10],
            'Plate Class_83': [9814, 1],
            'Serial Number_83': [9815, 8],
            'Make_83': [9823, 52],
            'Model_83': [9875, 6],
            'Manuf Year_83': [9881, 4],
            'Status_83': [9885, 20],
            'Expiry Date_83': [9905, 8],
            'Cancelled Scheduled date_83': [9913, 8],
            'Plate Number_84': [9921, 10],
            'Plate Class_84': [9931, 1],
            'Serial Number_84': [9932, 8],
            'Make_84': [9940, 52],
            'Model_84': [9992, 6],
            'Manuf Year_84': [9998, 4],
            'Status_84': [10002, 20],
            'Expiry Date_84': [10022, 8],
            'Cancelled Scheduled date_84': [10030, 8],
            'Plate Number_85': [10038, 10],
            'Plate Class_85': [10048, 1],
            'Serial Number_85': [10049, 8],
            'Make_85': [10057, 52],
            'Model_85': [10109, 6],
            'Manuf Year_85': [10115, 4],
            'Status_85': [10119, 20],
            'Expiry Date_85': [10139, 8],
            'Cancelled Scheduled date_85': [10147, 8],
            'Plate Number_86': [10155, 10],
            'Plate Class_86': [10165, 1],
            'Serial Number_86': [10166, 8],
            'Make_86': [10174, 52],
            'Model_86': [10226, 6],
            'Manuf Year_86': [10232, 4],
            'Status_86': [10236, 20],
            'Expiry Date_86': [10256, 8],
            'Cancelled Scheduled date_86': [10264, 8],
            'Plate Number_87': [10272, 10],
            'Plate Class_87': [10282, 1],
            'Serial Number_87': [10283, 8],
            'Make_87': [10291, 52],
            'Model_87': [10343, 6],
            'Manuf Year_87': [10349, 4],
            'Status_87': [10353, 20],
            'Expiry Date_87': [10373, 8],
            'Cancelled Scheduled date_87': [10381, 8],
            'Plate Number_88': [10389, 10],
            'Plate Class_88': [10399, 1],
            'Serial Number_88': [10400, 8],
            'Make_88': [10408, 52],
            'Model_88': [10460, 6],
            'Manuf Year_88': [10466, 4],
            'Status_88': [10470, 20],
            'Expiry Date_88': [10490, 8],
            'Cancelled Scheduled date_88': [10498, 8],
            'Plate Number_89': [10506, 10],
            'Plate Class_89': [10516, 1],
            'Serial Number_89': [10517, 8],
            'Make_89': [10525, 52],
            'Model_89': [10577, 6],
            'Manuf Year_89': [10583, 4],
            'Status_89': [10587, 20],
            'Expiry Date_89': [10607, 8],
            'Cancelled Scheduled date_89': [10615, 8],
            'Plate Number_90': [10623, 10],
            'Plate Class_90': [10633, 1],
            'Serial Number_90': [10634, 8],
            'Make_90': [10642, 52],
            'Model_90': [10694, 6],
            'Manuf Year_90': [10700, 4],
            'Status_90': [10704, 20],
            'Expiry Date_90': [10724, 8],
            'Cancelled Scheduled date_90': [10732, 8],
            'Plate Number_91': [10740, 10],
            'Plate Class_91': [10750, 1],
            'Serial Number_91': [10751, 8],
            'Make_91': [10759, 52],
            'Model_91': [10811, 6],
            'Manuf Year_91': [10817, 4],
            'Status_91': [10821, 20],
            'Expiry Date_91': [10841, 8],
            'Cancelled Scheduled date_91': [10849, 8],
            'Plate Number_92': [10857, 10],
            'Plate Class_92': [10867, 1],
            'Serial Number_92': [10868, 8],
            'Make_92': [10876, 52],
            'Model_92': [10928, 6],
            'Manuf Year_92': [10934, 4],
            'Status_92': [10938, 20],
            'Expiry Date_92': [10958, 8],
            'Cancelled Scheduled date_92': [10966, 8],
            'Plate Number_93': [10974, 10],
            'Plate Class_93': [10984, 1],
            'Serial Number_93': [10985, 8],
            'Make_93': [10993, 52],
            'Model_93': [11045, 6],
            'Manuf Year_93': [11051, 4],
            'Status_93': [11055, 20],
            'Expiry Date_93': [11075, 8],
            'Cancelled Scheduled date_93': [11083, 8],
            'Plate Number_94': [11091, 10],
            'Plate Class_94': [11101, 1],
            'Serial Number_94': [11102, 8],
            'Make_94': [11110, 52],
            'Model_94': [11162, 6],
            'Manuf Year_94': [11168, 4],
            'Status_94': [11172, 20],
            'Expiry Date_94': [11192, 8],
            'Cancelled Scheduled date_94': [11200, 8],
            'Plate Number_95': [11208, 10],
            'Plate Class_95': [11218, 1],
            'Serial Number_95': [11219, 8],
            'Make_95': [11227, 52],
            'Model_95': [11279, 6],
            'Manuf Year_95': [11285, 4],
            'Status_95': [11289, 20],
            'Expiry Date_95': [11309, 8],
            'Cancelled Scheduled date_95': [11317, 8],
            'Plate Number_96': [11325, 10],
            'Plate Class_96': [11335, 1],
            'Serial Number_96': [11336, 8],
            'Make_96': [11344, 52],
            'Model_96': [11396, 6],
            'Manuf Year_96': [11402, 4],
            'Status_96': [11406, 20],
            'Expiry Date_96': [11426, 8],
            'Cancelled Scheduled date_96': [11434, 8],
            'Plate Number_97': [11442, 10],
            'Plate Class_97': [11452, 1],
            'Serial Number_97': [11453, 8],
            'Make_97': [11461, 52],
            'Model_97': [11513, 6],
            'Manuf Year_97': [11519, 4],
            'Status_97': [11523, 20],
            'Expiry Date_97': [11543, 8],
            'Cancelled Scheduled date_97': [11551, 8],
            'Plate Number_98': [11559, 10],
            'Plate Class_98': [11569, 1],
            'Serial Number_98': [11570, 8],
            'Make_98': [11578, 52],
            'Model_98': [11630, 6],
            'Manuf Year_98': [11636, 4],
            'Status_98': [11640, 20],
            'Expiry Date_98': [11660, 8],
            'Cancelled Scheduled date_98': [11668, 8],
            'Plate Number_99': [11676, 10],
            'Plate Class_99': [11686, 1],
            'Serial Number_99': [11687, 8],
            'Make_99': [11695, 52],
            'Model_99': [11747, 6],
            'Manuf Year_99': [11753, 4],
            'Status_99': [11757, 20],
            'Expiry Date_99': [11777, 8],
            'Cancelled Scheduled date_99': [11785, 8],
            'Plate Number_100': [11793, 10],
            'Plate Class_100': [11803, 1],
            'Serial Number_100': [11804, 8],
            'Make_100': [11812, 52],
            'Model_100': [11864, 6],
            'Manuf Year_100': [11870, 4],
            'Status_100': [11874, 20],
            'Expiry Date_100': [11894, 8],
            'Cancelled Scheduled date_100': [11902, 8]
        }

        _ = lines.pop(0)
        trailer_row = lines.pop()
        trailer = trailer_row['raw_row']
        number_of_rows = int(trailer[3:10])

        if number_of_rows != len(lines):
            logger.error('failed parsing, total no of records does not match expected records', extra={'data': {
                'total_records': str(len(lines)),
                'expected_records': str(number_of_rows)
            }})
            trailer_row['ClientId'] = " "
            trailer_row['Name'] = " "
            trailer_row['record_no'] = int(len(lines)) + 1

            self.report_invalid_row(trailer_row,
                                    reason='Detail records does not match the total record count in the trailer record',
                                    position_data=[4, 7])
            return []

        rows = []
        for i, _line in enumerate(lines):
            line = _line['raw_row']
            _line['record_no'] = i
            try:
                data_dict = {
                    header: line[pad[0] - 1: (pad[0] - 1) + pad[1]].strip() for header, pad in headers.items()
                }
                row = {**data_dict, **_line}

                if not self.validate_business_rules(row, headers):
                    continue

                # convert name and salutation to capital case
                row['Name'] = row['Name'].title()
                row['DerivedName'] = row['Name']

                if row['NameLine2']:
                    row['NameLine2'] = row['NameLine2'].title()
                    row['DerivedName'] = '{} {}'.format(row['Name'], row['NameLine2'])

                # name for Metadata report
                row['FullName'] = row['DerivedName']

                row['Salutation'] = row['Salutation'].title()

                # date formatting
                row['Cancelled Scheduled date_1'] = self.get_formatted_date(row['Cancelled Scheduled date_1'])

                # generate address line3
                row['Post_Address_3'] = self.get_address_line3(
                    row['Post_Suburb'],
                    row['Post_State'],
                    row['PostCode'])

                # format address lines
                formatted_addresses = self.get_formatted_address([row['Post_Address_1'], row['Post_Address_2'], row['Post_Address_3']])
                row['Post_Address_1'] = formatted_addresses[0]
                row['Post_Address_2'] = formatted_addresses[1]
                row['Post_Address_3'] = formatted_addresses[2]

                # get current date
                row['SystemDate'] = self.get_current_system_date()

                # email subject
                row['EmailSubject'] = self.email_subject(row)

                rows.append(row)
            except Exception as e:
                self.report_invalid_row(_line, reason='failed parsing line {}'.format(str(e)))

        return rows

    def validate_business_rules(self, row: dict, headers: dict):
        try:
            # invalid record if client no is invalid
            if not row[Structure.profile_table_mappings['client_id']]:
                self.report_invalid_row(row,
                                        reason='Invalid licence number - blank field',
                                        position_data=headers[Structure.profile_table_mappings['client_id']])
                return False
        except Exception as e:
            logger.warning('failed processing business rules', extra={'data': str(e)})
            self.report_invalid_row(row, reason='failed processing business rule {}'.format(str(e)))
            return False
        return True

    def email_template(self) -> str:
        return 'generic/template1.html'

    def mail_template(self) -> str:
        return '{}/mail-template.html'.format(self.product_family_name)

    def sms_template(self) -> str:
        pass

    def html_template(self) -> str:
        pass

    def email_subject(self, row) -> str:
        pass

    def history_title(self, row: dict) -> str:
        if row['LetterType'] == '070':
            return 'Cancellation of your registration(s) might happen due to company de-registration'
        elif row['LetterType'] == '090':
            return 'A suspension has been removed from your drivers licence(s) and registration(s)'
        return 'You have a message'

    def correspondence_metadata(self, row) -> str:
        return '-'
